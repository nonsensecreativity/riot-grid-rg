riot.tag2("rg",'<div class="riotGrid"> <div class="riotGridHeader {topPanelCss}"> <span if="{allowSearch==true}"> <input type="text" id="txtSearch" placeholder="enter text to search"> <button type="button" onclick="{btnSearchClicked}"><i class="glyphicon glyphicon-search"></i>&nbsp;{searchBtnText}</button> <button type="button" onclick="{btnClearSearchClicked}"><i class="glyphicon glyphicon-remove"></i>&nbsp;{clearSearchBtnText}</button> </span> <button type="button" if="{allowAddNew==true}" onclick="{btnAddNewClicked}">{addNewBtnText}</button> <button type="button" if="{allowExport==true}" onclick="{btnExportClicked}">{exportBtnText}</button> <button type="button" onclick="{btnShowFilters}" if="{allowFilters==true}"> <i class="glyphicon glyphicon-filter"></i>&nbsp;{showFilters==true? hideFilterBtnText: showFilterBtnText} </button> <span style="float: right">{totalLblText}&nbsp;{formatNumber(data.length)} {recLblText}</span> </div> <div class="riotGridBody"> <div> <div class="riotGridBodyDetail"> <table class="rg-table tableBody"> <thead> <tr> <th each="{cols}" riot-style="width:{width? width:\'50px\'};" class="{this.headerCss}" data-field="{id}"><a data-field="{id}" onclick="{sortData}">{title}</a></th> </tr> <tr show="{showFilters}"> <th each="{cols}" riot-style="width:{width? width:\'50px\'};" class="{this.headerCss}" data-field="{id}"><input type="text" class="input-filter" onkeyup="{filterData}" data-field="{id}"></th> </tr> </thead> <tbody> <tr data-is="rg-cells" each="{e, index in gridData}" class="{e.css} {rg-selectedRow: JSON.stringify(rgSelectedRow) === JSON.stringify(e), rg-altRow: (index % 2 == 1)}" ondblclick="{rowDbClick}" onclick="{rowClicked}"></tr> </tbody> </table> </div> </div> </div> <div class="riotGridFooter {bottomPanelCss}"> <div class="btnLeft {topPanelBkgColor}"> <div class="btnGroup" show="{rgSelectedRow}"> <button each="{buttonLefts}" type="button" class="{css}" data-field="{value}" onclick="{btnClicked}" name="{name}">{btnName}</button> </div> </div> <div class="paging"> <button type="button" onclick="{btnFirstRecordClicked}" __disabled="{!(selectedPage>0)}"> <strong>{firstBtnText}</strong> </button> <button type="button" onclick="{btnPreRecordClicked}" __disabled="{!(selectedPage>0)}"> <strong>{prevBtnText}</strong> </button> <select id="cboPages" onchange="{cboPagesChanged}"> <option value="{pageNo}" each="{pages}" __selected="{selectedPage==pageNo}">{pageNo+1}</option> </select> <span>/{pages.length}</span> <button type="button" onclick="{btnNextRecordClicked}" __disabled="{!(selectedPage<pages.length-1)}"> <strong>{nextBtnText}</strong> </button> <button type="button" onclick="{btnLastRecordClicked}" __disabled="{!(selectedPage<pages.length-1)}"> <strong>{lastBtnText}</strong> </button> </div> <div class="btnRight"> <div class="btnGroup" show="{rgSelectedRow}"> <button each="{buttonRights}" type="button" class="{css}" data-field="{value}" onclick="{btnClicked}" name="{name}">{btnName}</button> </div> </div> </div> </div>','rg .rg-show-more,[riot-tag="rg"] .rg-show-more,[data-is="rg"] .rg-show-more{ overflow-y: auto !important; overflow-x: hidden; max-height: 200px; min-height: 30px; white-space: normal !important; display: block; } rg a,[riot-tag="rg"] a,[data-is="rg"] a{ cursor: pointer; } rg .paging,[riot-tag="rg"] .paging,[data-is="rg"] .paging{ text-align: center; align-content: center; display: table-cell; width: 33.33%; } rg .btnRight,[riot-tag="rg"] .btnRight,[data-is="rg"] .btnRight{ display: table-cell; align-content: flex-end; width: 33.33%; text-align: right; } rg .btnLeft,[riot-tag="rg"] .btnLeft,[data-is="rg"] .btnLeft{ display: table-cell; align-content: flex-start; width: 33.33%; } rg .rg-left,[riot-tag="rg"] .rg-left,[data-is="rg"] .rg-left{ text-align: left; } rg .rg-right,[riot-tag="rg"] .rg-right,[data-is="rg"] .rg-right{ text-align: right; } rg .rg-center,[riot-tag="rg"] .rg-center,[data-is="rg"] .rg-center{ text-align: center; } rg .riotGridHeader,[riot-tag="rg"] .riotGridHeader,[data-is="rg"] .riotGridHeader,rg .riotGridBody,[riot-tag="rg"] .riotGridBody,[data-is="rg"] .riotGridBody{ display: block; width: 100%; padding: 3px; border: 1px solid #808080; } rg .riotGridBody,[riot-tag="rg"] .riotGridBody,[data-is="rg"] .riotGridBody{ max-width: 100%; overflow: auto; } rg .riotGridFooter,[riot-tag="rg"] .riotGridFooter,[data-is="rg"] .riotGridFooter{ background-color: #bed9db; } rg .riotGridHeader,[riot-tag="rg"] .riotGridHeader,[data-is="rg"] .riotGridHeader{ background-color: #eafbfc; } rg .riotGridFooter,[riot-tag="rg"] .riotGridFooter,[data-is="rg"] .riotGridFooter{ display: flex; width: 100%; padding: 3px; border: 1px solid #808080; background-color: #bed9db; } rg .riotGridBodyDetail,[riot-tag="rg"] .riotGridBodyDetail,[data-is="rg"] .riotGridBodyDetail{ max-width: 100%; overflow-y: auto; height: 500px; margin: 0px; } rg ::-webkit-scrollbar,[riot-tag="rg"] ::-webkit-scrollbar,[data-is="rg"] ::-webkit-scrollbar{ width: 0.5em; height: 0.5em; } rg ::-webkit-scrollbar-track,[riot-tag="rg"] ::-webkit-scrollbar-track,[data-is="rg"] ::-webkit-scrollbar-track{ -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3); } rg ::-webkit-scrollbar-thumb,[riot-tag="rg"] ::-webkit-scrollbar-thumb,[data-is="rg"] ::-webkit-scrollbar-thumb{ background-color: maroon; outline: 1px solid red; } rg .riotGridFixHeader,[riot-tag="rg"] .riotGridFixHeader,[data-is="rg"] .riotGridFixHeader{ max-width: 100%; overflow: hidden; margin: 0px; padding-right: 5px; } rg .rg-table tbody,[riot-tag="rg"] .rg-table tbody,[data-is="rg"] .rg-table tbody{ overflow-y: scroll; } rg .rg-table,[riot-tag="rg"] .rg-table,[data-is="rg"] .rg-table{ border-spacing: 0; table-layout: fixed; } rg .rg-table td,[riot-tag="rg"] .rg-table td,[data-is="rg"] .rg-table td,rg th,[riot-tag="rg"] th,[data-is="rg"] th{ border: 1px solid #eee; padding: 3px; overflow: hidden; white-space: nowrap; } rg .rg-table th,[riot-tag="rg"] .rg-table th,[data-is="rg"] .rg-table th{ text-align: center; background-color: black; color: yellow !important; } rg .rg-table th a,[riot-tag="rg"] .rg-table th a,[data-is="rg"] .rg-table th a{ color: yellow !important; } rg .rg-table th.resizing,[riot-tag="rg"] .rg-table th.resizing,[data-is="rg"] .rg-table th.resizing{ cursor: col-resize; } rg .rg-table th input,[riot-tag="rg"] .rg-table th input,[data-is="rg"] .rg-table th input{ width: 100%; max-width: 100%; background-color: lightyellow; border: 0.01em solid #808080; color: black; font-weight: normal; } rg .selectedRow,[riot-tag="rg"] .selectedRow,[data-is="rg"] .selectedRow{ background-color: yellow !important; } rg .rg-checkbox,[riot-tag="rg"] .rg-checkbox,[data-is="rg"] .rg-checkbox{ cursor: pointer; width: 16px; height: 16px; display: block; background-repeat: no-repeat; margin: 0 auto; }',"",function(a){this.cols=[],this.data=[],this.rawData=[],this.gridData=[],this.pages=[],this.sorted={field:"ID",sort:"desc"},this.rgSelectedRow=null,this.showFilters=!1,this.rowNoWidth=30,this.buttonLefts=[],this.buttonRights=[],this.listCount=20,this.selectedPage=0,this.gridHeight="500px",this.gridName="Data",this.gridWidth="100%",this.allowAddNew=!0,this.allowExport=!0,this.allowSearch=!0,this.allowFilters=!0,this.buttons=[{btnName:"View",triggerName:"select"},{btnName:"Delete",triggerName:"del",buttonPosition:"right"},{btnName:"Edit",triggerName:"edit"}],this.press=!1,this.moving=!1,this.key="ID",this.allowResizeCol=!0,this.addNewBtnText="Add New",this.showFilterBtnText="Show Filters",this.searchBtnText="Search",this.clearSearchBtnText="Clear Search",this.exportBtnText="Export to CSV",this.nextBtnText=">",this.prevBtnText="<",this.firstBtnText="<<",this.lastBtnText=">>",this.totalLblText="Total:",this.recLblText="records",this.hideFilterBtnText="Hide Filters",this.dateFormat="DD/MMM/YYYY",this.altRowColor="#e8ecf2",this.rowColor="transparent",this.hoverRowColor="#c5f7f9",this.selectedRowColor="#54eef9",this.headerCss=null,this.bottomPanelCss=null,this.topPanelCss=null;var c,d,e,b=this,b=this;this.loadData=function(a,c){var d=Object.assign({},c);for(var e in d)b[e]=d[e];b.buttonLefts=[],b.buttonRights=[],b.buttons&&b.buttons.length>0&&(b.buttonLefts=(new jinqJs).from(b.buttons).where(function(a){return null==a.buttonPosition||"left"==a.buttonPosition}).select(),b.buttonRights=(new jinqJs).from(b.buttons).where(function(a){return"right"==a.buttonPosition}).select()),b.jsonToArray(a),b.update()},this.mouseEventInit=function(){b.allowResizeCol&&(this.root.addEventListener("mouseup",function(a){if(null!=e&&1==b.moving&&1==b.press){e.className=e.className.replace(/resizing/g,""),b.press=!1,b.moving=!1;for(var c in b.cols)if(b.cols[c].id==e.getAttribute("data-field")){b.cols[c].width=e.style.width;break}e=null}},!1),this.root.addEventListener("mousemove",function(a){if(e&&b.press&&a.pageX-c!=0){var f=d+(a.pageX-c);return e.style.width=f+"px",void(b.moving=!0)}},!1))},this.mousedown=function(a){b.allowResizeCol&&(c=a.pageX,d=a.target.offsetWidth,b.press=!0,e=a.target,e.className+=" resizing",b.mouseEventInit())},this.btnAddNewClicked=function(){b.trigger("add",null)},this.reformatGrid=function(){var a=this.root.getElementsByClassName("riotGridBodyDetail")[0];a.style.height=b.gridHeight.toString();var c=this.root.getElementsByClassName("tableBody")[0];if(c){if(b.gridWidth&&(c.style.width=b.gridWidth),b.allowResizeCol){var d=c.getElementsByTagName("tr")[0];for(var f in d.childNodes){var g=d.childNodes[f];"object"==typeof g&&"TH"==g.tagName&&(g.removeEventListener("mousedown",b.mousedown,!1),g.addEventListener("mousedown",b.mousedown,!1))}}}else;},this.on("update",function(){if(0==b.cols.length){var a=[],c=document.getElementsByClassName("tableBody")[0];if(c&&(c=c.getElementsByTagName("tbody")[0],c=c.getElementsByTagName("tr")[0])){c=c.getElementsByTagName("td");for(var d=0;d<c.length;d++){var e=c[d],f={id:e.getAttribute("data-field"),width:e.getAttribute("rg-width")?e.getAttribute("rg-width"):"50px",title:e.title?e.title:e.id};a.push(f)}b.cols=a.slice();var g=document.createElement("style");g.type="text/css",g.innerHTML=".rg-selectedRow { background-color: "+b.selectedRowColor+" !important; }\n .rg-table tr:hover { background-color: "+b.hoverRowColor+"; }\n .rg-altRow { background-color: "+b.altRowColor+"; }",document.getElementsByTagName("head")[0].appendChild(g)}}}),this.on("updated",function(){b.reformatGrid()}),this.item=function(a){for(var c in b.gridData){var d=b.gridData[c];if(d[b.key]==a)return b.gridData[c]}},this.rowClicked=function(a){b.rgSelectedRow=a.item.e,b.trigger("rowClicked",b.rgSelectedRow);var c=a.target,d={item:b.rgSelectedRow,cell:c};b.trigger("cellClicked",d),c.className&&c.className.toString().toLowerCase().indexOf("rg-checkbox")>=0&&(a.item.e[c.dataset.field]=!a.item.e[c.dataset.field],b.trigger("chkClicked",d))},this.rowDbClick=function(a){b.trigger("rowDbClick",b.rgSelectedRow);var c=a.target,d={item:b.rgSelectedRow,cell:c};b.trigger("cellDbClick",d)},this.btnClicked=function(a){var c=b.rgSelectedRow;"checkbox"!=a.item.type&&"radio"!=a.item.type||(c.checked=a.target.checked),b.trigger(a.item.triggerName,c)},this.btnShowFilters=function(){b.showFilters&&(b.data=b.rawData.slice(),b.getPages()),b.showFilters=!b.showFilters},this.filterData=function(a){if(b.data=b.rawData.slice(),b.data.length>0)for(var c=b.root.getElementsByClassName("input-filter"),d=0;d<c.length;d++){var e=c[d].getAttribute("data-field"),f=c[d].value.toLowerCase();f.length>0&&(b.data=(new jinqJs).from(b.data).where(function(a){return a[e].toString().toLowerCase().indexOf(f)>=0}).select())}b.getPages()},this.btnExportClicked=function(a){b.exportCSV(b.data,b.gridName,!0)},this.btnClearSearchClicked=function(){b.data=b.rawData.slice(),b.txtSearch.value="",b.getPages()},this.btnSearchClicked=function(){b.data=b.rawData.slice();var a=b.txtSearch.value.toLowerCase();a.length>0&&(b.data=(new jinqJs).from(b.data).where(function(c){var d=!1;for(var e in b.cols)if(0==d){var f=c[b.cols[e].id];f&&(f=f.toString().toLowerCase(),d=f.indexOf(a)>=0)}return d}).select()),b.getPages()},this.getPages=function(){b.pages=[];var a=parseInt(b.data.length/b.listCount);a<b.data.length/b.listCount&&a++;for(var c=0;c<a;c++)b.pages.push({pageNo:c});b.pageChanged()},this.sortData=function(a){if(b.data.length>0){var c=a.srcElement.dataset.field;b.sorted.field==c?b.sorted.sort="asc"==b.sorted.sort?"desc":"asc":(b.sorted.field=c,b.sorted.sort="asc");var d=[];d.push(b.sorted),b.data=(new jinqJs).from(b.data).orderBy(d).select()}b.pageChanged()},this.jsonToArray=function(a){null!=a&&(b.data=a,b.rawData=b.data.slice(),b.getPages())},this.cboPagesChanged=function(){b.selectedPage=b.cboPages.value,b.pageChanged()},this.pageChanged=function(){if(b.gridData=[],b.data.length>0){b.gridData=b.data.slice(b.selectedPage*b.listCount,b.selectedPage*b.listCount+b.listCount);for(var a=0;a<b.gridData.length;a++)b.gridData[a].rowNo=b.selectedPage*b.listCount+a+1}b.rgSelectedRow=null,b.trigger("pageChanged",b.selectedPage+1),0==b.cols.length&&b.update()},this.btnPreRecordClicked=function(){b.selectedPage=b.selectedPage-1,b.selectedPage<0&&(b.selectedPage=0),b.pageChanged()},this.btnFirstRecordClicked=function(){b.selectedPage=0,b.pageChanged()},this.btnLastRecordClicked=function(){b.selectedPage=b.pages.length-1,b.pageChanged()},this.btnNextRecordClicked=function(){b.selectedPage=b.selectedPage+1,b.selectedPage>b.pages.length&&(b.selectedPage=b.pages.length),b.pageChanged()},this.rgFormat=function(a,c,d,e){var f=a;if(c)switch(c){case"number":d=d?d:0,e=e?e:"",f=e+b.formatNumber(parseFloat(f),d);break;case"date":d=d?d:b.dateFormat,f=moment(f).format(d);break;case"bool":f=1==f?"YES":"NO";break;case"image":d=d?d:"",f='<img src="'+d+f+'" />'}return f}}),riot.tag2("rg-raw","","","",function(a){this.on("update",function(){this.root.innerHTML=a.content})}),riot.tag2("rg-checkbox","","","",function(a){this.on("update",function(){this.root.innerHTML='<input data-field="'+a.dataField+'" class="rg-checkbox" type="'+a.type+'" '+(a.content?"checked":"")+">"})}),riot.tag2("rg-image","","","",function(a){this.on("update",function(){this.root.innerHTML='<img style="max-height:100%; max-width:100%;" src="'+a.content+'" onerror="this.src=\'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\'; " />'})});
